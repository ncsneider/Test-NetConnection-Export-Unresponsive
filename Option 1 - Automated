$inputFile = "C:\PS Testing\ips.csv"
$exportFile = "C:\PS Testing\export.csv"
$report = @()

$ipAddresses = Import-CSV $inputFile 

foreach($ip in $ipAddresses)
{
    if((Test-NetConnection -ComputerName $ip.IP).PingSucceeded -eq $false)
    {
        $newRow = New-Object PsObject -Property @{
        Device = $ip.Device
        IP = $ip.IP
        Location = $ip.Location
        }
        $report += $newRow
    }
}
    
    
$report | Export-Csv -Path $exportFile -NoClobber -NoTypeInformation
